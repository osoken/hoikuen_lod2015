<!DOCTYPE html>
<meta charset='utf-8'>
<script src='js/vendor/d3.min.js'></script>
<link rel='stylesheet' href='js/vendor/leaflet/leaflet.css' />
<script src='js/vendor/leaflet/leaflet.js'></script>
<body>

<form id='token' method='POST'>
  <input type='hidden' name='client_id' />
  <input type='hidden' name='client_secret' />
  <input type='submit' value='token' />
</form>

<form id='mecre' method='POST'>
  <input type='text' name='nickname' />
  <input type='submit' />
</form>
<script>

var settings = {
  "hostname": "stg.ms10.oshiete.goo.ne.jp",
  "route": "/api/v1/lod04/",
  "uuid": "0c746539-2b1d-4d46-8ecc-954f4d3e3c7c",
  "nickname": "ee",
  "client_id": "lod04.api.oshiete.goo.ne.jp",
  "client_secret":"sz3wgrmPmzuzrlViqjlbwspjx2czppim"
}

d3.select('#token').attr('action', 'https://' + settings.hostname + settings.route + 'auth/access_token/create');
d3.select('#token input[name=client_id]').property('value', settings.client_id);
d3.select('#token input[name=client_secret]').property('value', settings.client_secret);

d3.select('#mecre')
  .on('submit', function()
  {
    d3.event.preventDefault();
    d3.json(endpoint + 'me/create')
      .header('X-Access-Token', token)
      .header("Content-type", "application/x-www-form-urlencoded")
      .post(encodeURI('nickname='+d3.select('#mecre input[name=nickname]').property('value')),function(err,dat){
        if (err != null)
        {
          var res = JSON.parse(err.response);
          d3.select('body').selectAll('span').data(d3.entries(res)).enter().append('span').text(function(d){return d.key+':'+d.value;});

        }
        console.log(err);
        console.log(dat);
      });
  });

</script>
